<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Jai Sri Ram</title>
  <script src="closure.js"></script>
  <script src="utils.js"></script>
  <script src="unicode_mappings.js"></script>
  <script src="converter.js"></script>
</head>
<style>
  #editor {
    width: 800px;
    height: 600px;
    background-color: white;
    border: 1px solid grey;
    font-size: xx-large;
    font-family: sans-serif;
    margin: 10px;
    padding: 10px;
  }
</style>

<body>
  <textarea id="editor" oninput="printchar();"></textarea>
  <script>
    //console = {};
    //console.log = function(){};
    sanskrit.setAsTypingLanguage();
    var editor = document.getElementById("editor");
    function printchar() {
      var str = editor.value;  // "abc|de"
      var pos = editor.selectionStart;  // 3

      var prev = str.substring(0, pos);  // "abc"
      var later = str.substring(pos);  // "de"
      var typed_char = '';
      if (prev.length > 0) {
        typed_char = prev[prev.length - 1];  // "c"
        prev = prev.substring(0, pos-1);  // "ab"
      }

      console.log("\n", prev, typed_char, "|", later);
      var ret = om.translit(prev, typed_char, later);
      editor.value = ret[0]+ret[1];
    }
  </script>
</body>
</html>
